<article class="markdown-body entry-content container-lg" itemprop="text">
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Обход фильтрации и обход WAF с использованием Application
            Layer Protocol (MITRE ATT&amp;CK T1071)
  </h2>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/114010875/427540891-a2742e60-8a79-44ea-8908-2dcf66827790.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQwODkxLWEyNzQyZTYwLThhNzktNDRlYS04OTA4LTJkY2Y2NjgyNzc5MC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00YjA2ZTY0NmMzZWQzNDZkNTYyNjA2NTE3NGFlNzQyYTI2ZDQ3Mjk4ODEzNjU5YjE2N2ZmNDA2YTMyN2VhZWQ2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.VuxddMfFJCTOJoaqEO56sDSZ0ipGcP9opqHH8wtFgYI" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/114010875/427540891-a2742e60-8a79-44ea-8908-2dcf66827790.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQwODkxLWEyNzQyZTYwLThhNzktNDRlYS04OTA4LTJkY2Y2NjgyNzc5MC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00YjA2ZTY0NmMzZWQzNDZkNTYyNjA2NTE3NGFlNzQyYTI2ZDQ3Mjk4ODEzNjU5YjE2N2ZmNDA2YTMyN2VhZWQ2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.VuxddMfFJCTOJoaqEO56sDSZ0ipGcP9opqHH8wtFgYI" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  В современном мире безопасности веб-приложений и серверных инфраструктур одним из наиболее
        распространенных средств защиты являются Web Application Firewalls (WAF). WAF системы предназначены для защиты
        от различных типов атак, таких как SQL-инъекции, XSS, RCE (Remote Code Execution) и других угроз. Однако,
        несмотря на свою эффективность, WAF могут быть обойдены с помощью определённых техник.
 </p>
 <p dir="auto">
  Одной из таких техник является использование Application Layer Protocols (T1071), которая включает в
        себя использование стандартных протоколов прикладного уровня, таких как HTTP, DNS или другие для обхода
        фильтрации и защиты. В этой статье мы рассмотрим, как можно применить этот метод для обхода WAF и других типов
        фильтрации на примере реальных CTF-задач.
 </p>
 <p dir="auto">
  Но перед тем как углубиться в эту технику, давайте кратко рассмотрим, что такое
  <strong>
   MITRE
            ATT&amp;CK
  </strong>
  и как эта база знаний помогает в контексте кибербезопасности.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Что такое MITRE ATT&amp;CK?
  </h3>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/114010875/427540738-9e51f81e-3e6e-4266-9406-2e26a17bdef6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQwNzM4LTllNTFmODFlLTNlNmUtNDI2Ni05NDA2LTJlMjZhMTdiZGVmNi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zMWEzZTY1NTRhZmVkMzVlNDhjMWQyZjMxZmUxYzQ3ZjQ4ZTNlZTIwNTk4NTM5MDVlNTUwYmRjYjNmODY0MGJmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.wYmrDt5jJTrTLTJhJjzR0RUlBFiWcIBnu_WqLvNa-ac" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/114010875/427540738-9e51f81e-3e6e-4266-9406-2e26a17bdef6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQwNzM4LTllNTFmODFlLTNlNmUtNDI2Ni05NDA2LTJlMjZhMTdiZGVmNi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zMWEzZTY1NTRhZmVkMzVlNDhjMWQyZjMxZmUxYzQ3ZjQ4ZTNlZTIwNTk4NTM5MDVlNTUwYmRjYjNmODY0MGJmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.wYmrDt5jJTrTLTJhJjzR0RUlBFiWcIBnu_WqLvNa-ac" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  <strong>
   MITRE ATT&amp;CK
  </strong>
  (Adversarial Tactics, Techniques, and Common Knowledge) — это база
        знаний, которая описывает поведение противников в киберпространстве. Она включает в себя набор тактик и техник,
        которые могут быть использованы злоумышленниками в ходе атак на информационные системы. ATT&amp;CK используется
        как для моделирования атак, так и для разработки эффективных методов защиты и обнаружения угроз.
 </p>
 <p dir="auto">
  Матрица MITRE ATT&amp;CK делит атакующие действия на несколько уровней, таких как тактики (общие цели
        злоумышленников) и техники (конкретные методы, с помощью которых эти цели могут быть достигнуты). Каждая техника
        в базе ATT&amp;CK также может включать примеры использования, уязвимости и способы защиты.
 </p>
 <p dir="auto">
  <strong>
   Тактика T1071
  </strong>
  — это одна из техник в матрице MITRE ATT&amp;CK, которая касается
        использования Application Layer Protocols для обхода фильтрации и защиты, таких как WAF. Эта техника может быть
        использована для уклонения от детекции и проникновения в защищённые системы.
 </p>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/114010875/427542406-57d76f48-098a-410f-a6fa-80a65bb08919.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQyNDA2LTU3ZDc2ZjQ4LTA5OGEtNDEwZi1hNmZhLTgwYTY1YmIwODkxOS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yMDA2MmQ4Mjg0YjA5Yjg3ODg1Nzk4M2FhZjRkY2ZjNWFkZWIxMTY3YmJhOTZiYmI4M2YwNjE0MGE0YmMyNjQzJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.mqJ2-e12KC3CPHV_zeGJMw9mEt_tMqeT7ghyQVA3zus" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/114010875/427542406-57d76f48-098a-410f-a6fa-80a65bb08919.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQyNDA2LTU3ZDc2ZjQ4LTA5OGEtNDEwZi1hNmZhLTgwYTY1YmIwODkxOS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yMDA2MmQ4Mjg0YjA5Yjg3ODg1Nzk4M2FhZjRkY2ZjNWFkZWIxMTY3YmJhOTZiYmI4M2YwNjE0MGE0YmMyNjQzJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.mqJ2-e12KC3CPHV_zeGJMw9mEt_tMqeT7ghyQVA3zus" style="max-width: 100%;"/>
  </a>
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Техники обхода с использованием Application Layer Protocol
  </h3>
 </div>
 <p dir="auto">
  <em>
   WAF (Web Application Firewall) — это система защиты веб-приложений, которая предназначена для
            фильтрации и мониторинга HTTP-запросов, направленных к веб-серверу, с целью защиты от различных типов атак,
            таких как SQL-инъекции, межсайтовые скрипты (XSS), обход аутентификации, атаки на уязвимости веб-приложений
            и многие другие.
  </em>
 </p>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/114010875/427543851-89195054-d989-44c6-8d42-69eeba9804e7.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQzODUxLTg5MTk1MDU0LWQ5ODktNDRjNi04ZDQyLTY5ZWViYTk4MDRlNy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hN2E0NWM0MDk4YzdlNTkyZTI5NDU4MWQ0OTZmZDE2YTY2ZjdkMThhNjU0YmZhNGY3ZmI3MTMzNTMyZGIxOWUwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.1WWuS-JQ8Ke6MNay9cYVQv_cy55StdEHKyMJes7bbbM" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/114010875/427543851-89195054-d989-44c6-8d42-69eeba9804e7.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQzODUxLTg5MTk1MDU0LWQ5ODktNDRjNi04ZDQyLTY5ZWViYTk4MDRlNy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hN2E0NWM0MDk4YzdlNTkyZTI5NDU4MWQ0OTZmZDE2YTY2ZjdkMThhNjU0YmZhNGY3ZmI3MTMzNTMyZGIxOWUwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.1WWuS-JQ8Ke6MNay9cYVQv_cy55StdEHKyMJes7bbbM" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  Обход WAF и фильтрации, как правило, основывается на манипуляции с данными, которые передаются между
        клиентом и сервером. Протоколы прикладного уровня предоставляют широкие возможности для таких манипуляций. Одним
        из самых популярных методов является использование нестандартных заголовков, параметров или методов HTTP для
        уклонения от обнаружения и фильтрации.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Использование нестандартных HTTP методов
  </h3>
 </div>
 <p dir="auto">
  Одним из основных способов обхода является использование нестандартных HTTP методов, таких как
        OPTIONS, TRACE или CONNECT. Эти методы могут быть разрешены на сервере, но часто не фильтруются WAF. В
        CTF-задачах мы часто видим, как такие методы можно использовать для получения доступа к уязвимостям веб-серверов
        или скрытых сервисов.
 </p>
 <p dir="auto">
  Для иллюстрации этого метода, представим задачу, где WAF ограничивает использование стандартных POST и
        GET запросов, но не фильтрует OPTIONS. В этом случае злоумышленник может отправить запрос с методом OPTIONS,
        чтобы выявить разрешённые HTTP методы, которые могут быть использованы для дальнейших атак.
 </p>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/114010875/427544159-f36e0bc4-1119-4bbc-99fd-ad96ba917061.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQ0MTU5LWYzNmUwYmM0LTExMTktNGJiYy05OWZkLWFkOTZiYTkxNzA2MS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04YjBhMTc0M2YxYmRjNjU2OTY2MmI4ZmRkNGE5YTRjZjNkMjY2MmNjYWY1MGQ0NWM0MzRmZTk1YWRjNDdkNmMyJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.9JJSAvX7fyHeMFdBPdz-42m32AtA0M_xNnSphuVNM04" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/114010875/427544159-f36e0bc4-1119-4bbc-99fd-ad96ba917061.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQ0MTU5LWYzNmUwYmM0LTExMTktNGJiYy05OWZkLWFkOTZiYTkxNzA2MS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04YjBhMTc0M2YxYmRjNjU2OTY2MmI4ZmRkNGE5YTRjZjNkMjY2MmNjYWY1MGQ0NWM0MzRmZTk1YWRjNDdkNmMyJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.9JJSAvX7fyHeMFdBPdz-42m32AtA0M_xNnSphuVNM04" style="max-width: 100%;"/>
  </a>
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Манипуляции с заголовками HTTP
  </h4>
 </div>
 <p dir="auto">
  Другим эффективным методом является манипуляция с заголовками HTTP. Например, злоумышленник может
        использовать заголовок X-Forwarded-For для подмены IP-адреса или отправить запросы с изменёнными заголовками
        User-Agent, чтобы избежать детекции. Протоколы, такие как HTTP, позволяют злоумышленнику подменить практически
        любой из заголовков, что даёт возможность скрыть реальное происхождение запроса и обойти фильтрацию WAF.
 </p>
 <p dir="auto">
  Одной из классических техник является использование X-Forwarded-For для обхода защиты, когда сервер
        использует WAF только для блокировки исходящих запросов с определённых IP-адресов. Однако, манипулируя этим
        заголовком, атакующий может подставить IP адрес из доверенного диапазона.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Обход WAF с использованием DNS
  </h4>
 </div>
 <p dir="auto">
  Ещё одна техника обхода, использующая Application Layer Protocol, заключается в применении
        DNS-туннелирования. В задачах CTF мы часто сталкиваемся с подобными приёмами, когда необходимо скрыть команду
        или данные от фильтрации, передавая их через DNS-запросы. Это позволяет создавать скрытые каналы связи между
        клиентом и сервером, обойдя все ограничения, установленные на HTTP уровне.
 </p>
 <p dir="auto">
  DNS-запросы могут быть использованы для маскировки трафика, а так как DNS-трафик часто не фильтруется
        и не блокируется, это даёт возможность злоумышленникам передавать команды и данные скрытно. Например, с помощью
        DNS tunneling можно провести скрипт, который будет передавать данные через DNS-запросы, минуя WAF.
 </p>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/114010875/427544497-f9566355-dbc0-4728-9396-ca435925b7f9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQ0NDk3LWY5NTY2MzU1LWRiYzAtNDcyOC05Mzk2LWNhNDM1OTI1YjdmOS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mNTg4MGQwZjJkNmUxMjYwMThhMWU2NTQ0NWQ5MTQxN2RiMjgwZDEzN2QzNzI0MTljN2Y0ZmU3MzAzMDJkMDdlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.4PTGnoa0KsXp_zlWu39wQnjFss3guEdXR-__dH46W6o" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/114010875/427544497-f9566355-dbc0-4728-9396-ca435925b7f9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQ0NDk3LWY5NTY2MzU1LWRiYzAtNDcyOC05Mzk2LWNhNDM1OTI1YjdmOS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mNTg4MGQwZjJkNmUxMjYwMThhMWU2NTQ0NWQ5MTQxN2RiMjgwZDEzN2QzNzI0MTljN2Y0ZmU3MzAzMDJkMDdlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.4PTGnoa0KsXp_zlWu39wQnjFss3guEdXR-__dH46W6o" style="max-width: 100%;"/>
  </a>
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Примеры атак и решений на CTF
  </h4>
 </div>
 <p dir="auto">
  Теперь давайте рассмотрим конкретные примеры атак, где использовалась техника T1071 для обхода WAF в
        реальных CTF-задачах. В одной из задач, встречающихся на соревнованиях, была поставлена цель — пройти через WAF,
        который фильтровал стандартные HTTP запросы. Решением стало использование нестандартных методов HTTP, таких как
        CONNECT, для обхода WAF. В другом примере, через манипуляцию с заголовками User-Agent удалось обойти защиту на
        уровне WAF, что привело к получению флага.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Как можно использовать MITRE ATT&amp;CK для защиты?
  </h4>
 </div>
 <p dir="auto">
  Использование базы данных MITRE ATT&amp;CK предоставляет ценную информацию для защиты информационных
        систем от современных угроз. Она помогает специалистам по безопасности более осознанно подходить к созданию и
        настройке систем защиты, а также позволяет более эффективно реагировать на атаки. Рассмотрим, как конкретно
        MITRE ATT&amp;CK может быть использован для защиты.
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Мониторинг и анализ угроз
  </h5>
 </div>
 <p dir="auto">
  Одной из важнейших задач в области кибербезопасности является мониторинг трафика и активностей в сети
        для своевременного обнаружения возможных атак. Знание техник из MITRE ATT&amp;CK позволяет настроить системы
        мониторинга таким образом, чтобы они могли детектировать подозрительную активность, которая может быть связана с
        конкретными методами атак. Например, если злоумышленник использует технику T1071 для обхода WAF с помощью
        стандартных протоколов, таких как HTTP или DNS, системы безопасности, понимающие суть этих техник, могут быть
        настроены на детекцию аномального поведения в запросах, включая нестандартные HTTP-заголовки или странные
        DNS-запросы. Это знание позволяет анализировать паттерны трафика и активностей, выявляя признаки того, что атака
        может быть на подходе или уже осуществляется.
 </p>
 <p dir="auto">
  Внедрение такого подхода к мониторингу помогает оперативно реагировать на инциденты, минимизировать
        ущерб и проводить глубокий анализ атак в реальном времени, повышая общую защищённость сети.
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Тестирование на проникновение
  </h5>
 </div>
 <p dir="auto">
  Другим важным применением MITRE ATT&amp;CK в области защиты является использование его техник для
        проведения тестов на проникновение. Профессиональные специалисты по безопасности могут использовать известные
        техники, такие как T1071: Application Layer Protocol, для проверки защищенности своих систем. Например, зная,
        что злоумышленники могут обходить WAF, манипулируя заголовками HTTP или используя нестандартные методы
        HTTP-запросов, тестировщики могут намеренно использовать эти методы для проверки, насколько эффективна система
        фильтрации трафика.
 </p>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/114010875/427546254-945036e7-13db-4285-96f6-ca77b77a5c63.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQ2MjU0LTk0NTAzNmU3LTEzZGItNDI4NS05NmY2LWNhNzdiNzdhNWM2My5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jZjg1MjVkZDIyODc5ZmI3ZGZmMzg3ODI1OWFiMWI4MmJlNjRlMjFmN2M2ZjI1M2NiMmIzMzZiZDZkNGY4NzY5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.oqQRKtGAuLWmout7WHqk4Gqc_7bgLfiypN1gio-MK_o" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/114010875/427546254-945036e7-13db-4285-96f6-ca77b77a5c63.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDg5MTAsIm5iZiI6MTc0NTE0ODYxMCwicGF0aCI6Ii8xMTQwMTA4NzUvNDI3NTQ2MjU0LTk0NTAzNmU3LTEzZGItNDI4NS05NmY2LWNhNzdiNzdhNWM2My5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTMwMTBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jZjg1MjVkZDIyODc5ZmI3ZGZmMzg3ODI1OWFiMWI4MmJlNjRlMjFmN2M2ZjI1M2NiMmIzMzZiZDZkNGY4NzY5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.oqQRKtGAuLWmout7WHqk4Gqc_7bgLfiypN1gio-MK_o" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  Такой подход позволяет выявить слабые места в системе безопасности, которые могут быть не заметны на
        первый взгляд. Процесс тестирования на проникновение с применением техник MITRE ATT&amp;CK помогает не только
        обнаружить уязвимости, но и отработать сценарии, в которых атакующие могут попытаться скрыться от стандартных
        средств защиты. Это помогает создать более стойкие системы защиты, которые способны справляться с угрозами,
        использующими эти техники.
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Разработка системы защиты
  </h5>
 </div>
 <p dir="auto">
  Знание техник атак, представленных в MITRE ATT&amp;CK, даёт возможность разрабатывать более
        совершенные системы защиты. Например, если известно, что злоумышленники используют HTTP-заголовки для обхода
        защиты, специалисты могут интегрировать дополнительные механизмы, которые будут тщательно анализировать все
        заголовки и запросы, чтобы выявить аномальные или подозрительные данные. В случае с техникой T1071, это может
        включать в себя внедрение дополнительных слоёв защиты на уровне прикладных протоколов, таких как глубокая
        проверка HTTP-трафика или DNS-запросов на предмет попыток эксфильтрации данных.
 </p>
 <p dir="auto">
  Кроме того, понимание того, какие методы атаки используются на каждом этапе атаки, позволяет внедрить
        многоуровневую защиту. Это может включать использование фильтров на уровне сети, детектирование необычного
        трафика или аномальных моделей поведения, а также продвинутые алгоритмы машинного обучения для распознавания
        атак, которые иначе могли бы пройти незамеченными. Знание техник из MITRE ATT&amp;CK помогает строить стратегии
        защиты, направленные на конкретные способы атаки, что значительно повышает общий уровень безопасности.
 </p>
 <hr/>
 <p dir="auto">
  Использование Application Layer Protocols для обхода фильтрации и WAF является важной техникой,
        которую можно применить в реальных атаках, а также на соревнованиях CTF. Эта техника открывает широкие
        возможности для манипуляций с запросами, использующими нестандартные методы, заголовки и другие параметры
        протоколов. Однако, важно помнить, что WAF и другие системы фильтрации продолжают эволюционировать, и атаки
        через Application Layer Protocols также будут совершенствоваться.
 </p>
 <p dir="auto">
  Для защиты от подобных техник необходимо постоянно обновлять и усиливать механизмы фильтрации и
        мониторинга, а также проводить регулярные тесты на проникновение для выявления слабых мест.
 </p>
</article>
