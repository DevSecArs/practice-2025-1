<article class="markdown-body entry-content container-lg" itemprop="text">
 <div class="markdown-heading" dir="auto">
  <h1 class="heading-element" dir="auto" tabindex="-1">
   Что такое IDS/IPS? Методы обхода систем обнаружения
            вторжений (IDS/IPS) Техники обхода IDS/IPS систем.
  </h1>
 </div>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Основные понятия и отличия IDS и IPS
  </h2>
 </div>
 <p dir="auto">
  <a href="https://github.com/AnaktaCTF/CTFReports/blob/main/gayechka/png/IPS_vs_IDS.jpg" rel="noopener noreferrer" target="_blank">
   <img alt="" src="https://github.com/AnaktaCTF/CTFReports/raw/main/gayechka/png/IPS_vs_IDS.jpg" style="max-width: 100%;"/>
  </a>
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Система обнаружения вторжений (IDS)
  </h3>
 </div>
 <p dir="auto">
  IDS (Intrusion Detection System) — это система, которая постоянно отслеживает сетевой трафик и
        активность в сети с целью выявления подозрительных действий или отклонений от нормального поведения. Основной
        механизм работы IDS — это анализ сетевых пакетов и действий пользователей на предмет потенциальных угроз и
        аномалий. Например, если система обнаруживает повышенное количество запросов к базе данных в нерабочее время или
        неожиданно высокую активность со стороны одного пользователя, это может свидетельствовать о возможной угрозе,
        будь то взлом учетной записи или начало атаки.
 </p>
 <p dir="auto">
  IDS помогает оперативно обнаруживать такие аномалии и предупреждать специалистов по информационной
        безопасности о возможных угрозах. Пример сценария: в нормальных условиях учетная запись обычного пользователя не
        должна получать доступ к критическим системам компании, но если IDS фиксирует такой запрос, это может
        свидетельствовать о компрометации учетной записи. В таких случаях IDS генерирует уведомление, передавая его в
        виде оповещения команде специалистов, которые оперативно анализируют проблему и предпринимают необходимые
        действия. Важно отметить, что IDS — это "наблюдатель", задача которого состоит в том, чтобы сообщить о
        потенциальной угрозе и помочь выявить проблему на ранней стадии.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Система предотвращения вторжений (IPS)
  </h3>
 </div>
 <p dir="auto">
  IPS (Intrusion Prevention System) выполняет схожие функции, но идет дальше. В отличие от IDS, которая
        уведомляет о возможных угрозах, IPS активно блокирует вредоносные действия, вмешиваясь в трафик в режиме
        реального времени. IPS работает как "щит", моментально реагируя на подозрительную активность и предотвращая
        развитие угрозы. Например, если IPS определяет, что в сеть пытается проникнуть вредоносное ПО или происходит
        распределенная атака типа DDoS, она немедленно прерывает такие попытки и блокирует подозрительные пакеты.
 </p>
 <p dir="auto">
  Один из примеров — ситуация, когда система обнаруживает попытки перебора паролей (так называемый brute
        force). IPS может временно заблокировать IP-адрес источника таких попыток или наложить ограничения на доступ,
        что существенно снижает вероятность успешного взлома. IPS также способна настраиваться для фильтрации и
        блокировки специфических типов трафика, как, например, подозрительные запросы к веб-приложениям, чтобы
        предотвращать SQL-инъекции и XSS-атаки. За счет такой проактивной защиты IPS устраняет угрозы до того, как они
        смогут нанести ущерб.
 </p>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Глубокое понимание архитектуры и принципов работы IDS/IPS
  </h2>
 </div>
 <p dir="auto">
  Прежде чем рассматривать методы обхода, необходимо глубокое понимание принципов работы и архитектуры
        IDS/IPS. Эти системы анализируют сетевой трафик на предмет вредоносных сигнатур, аномального поведения и
        нарушений протоколов. Существуют различные типы IDS/IPS, включая:
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Сетевые IDS/IPS (NIDS/NIPS):
  </h3>
 </div>
 <p dir="auto">
  Анализируют трафик, проходящий через определенный сегмент сети.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Хостовые IDS/IPS (HIDS/HIPS):
  </h3>
 </div>
 <p dir="auto">
  Устанавливаются на отдельные хосты и анализируют активность на этих хостах.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Беспроводные IDS/IPS (WIDS/WIPS):
  </h3>
 </div>
 <p dir="auto">
  Мониторят беспроводные сети на предмет несанкционированного доступа и вредоносной активности.
 </p>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   IDS/IPS используют различные методы обнаружения, в том
            числе:
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Сигнатурный анализ:
  </h3>
 </div>
 <p dir="auto">
  Сопоставление трафика с известными вредоносными сигнатурами.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Анализ аномалий:
  </h3>
 </div>
 <p dir="auto">
  Выявление отклонений от нормального поведения сети или хоста.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Анализ протоколов:
  </h3>
 </div>
 <p dir="auto">
  Проверка соответствия трафика стандартам протоколов и выявление нарушений.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Анализ политик:
  </h3>
 </div>
 <p dir="auto">
  Сопоставление трафика с определенными правилами и политиками безопасности.
 </p>
 <p dir="auto">
  IDS и IPS работают на достижение одной цели — защиты сети от атак, но выполняют разные роли в этом
        процессе. Основное отличие заключается в способе реагирования: IDS фиксирует и уведомляет о возможной угрозе, а
        IPS предпринимает действия для ее устранения. Оба подхода имеют свои преимущества, и, несмотря на различия, эти
        системы часто работают вместе, дополняя друг друга.
 </p>
 <p dir="auto">
  Имея IDS, компания может отслеживать все потенциальные угрозы и аномалии, сохраняя историю активности,
        что особенно полезно для анализа угроз и повышения уровня безопасности в будущем. В то же время IPS обеспечивает
        активную защиту и мгновенную реакцию, блокируя любые нежелательные действия еще до того, как они доберутся до
        критически важных систем компании. Комплексный подход, использующий и IDS, и IPS, позволяет достичь высокого
        уровня киберзащиты, благодаря которому компания может не только обнаруживать и анализировать угрозы, но и
        оперативно предотвращать их, минимизируя риски и ущерб.
 </p>
 <p dir="auto">
  <a href="https://github.com/AnaktaCTF/CTFReports/blob/main/gayechka/png/IDS_IPS.png" rel="noopener noreferrer" target="_blank">
   <img alt="" src="https://github.com/AnaktaCTF/CTFReports/raw/main/gayechka/png/IDS_IPS.png" style="max-width: 100%;"/>
  </a>
 </p>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Несмотря на свою эффективность, IDS/IPS имеют определенные
            ограничения, такие как:
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Ложные срабатывания (False Positives):
  </h3>
 </div>
 <p dir="auto">
  Обнаружение нормального трафика как вредоносного.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Ложные пропуски (False Negatives):
  </h3>
 </div>
 <p dir="auto">
  Необнаружение реальной вредоносной активности.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Зависимость от актуальности сигнатур:
  </h3>
 </div>
 <p dir="auto">
  Неспособность обнаруживать новые, неизвестные атаки.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Проблемы с анализом зашифрованного трафика:
  </h3>
 </div>
 <p dir="auto">
  Сложность анализа трафика, зашифрованного с использованием TLS/SSL и других протоколов.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Интенсивное использование ресурсов:
  </h3>
 </div>
 <p dir="auto">
  Анализ трафика требует значительных вычислительных ресурсов.
 </p>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Методы обхода систем обнаружения вторжений (IDS/IPS)
  </h2>
 </div>
 <p dir="auto">
  Системы обнаружения и предотвращения вторжений (IDS/IPS) играют важнейшую роль в современной
        кибербезопасности, обеспечивая защиту от вредоносной активности путем анализа сетевого трафика и выявления
        подозрительных шаблонов. Однако злоумышленники постоянно разрабатывают более изощренные методы обхода этих
        систем, стремясь проникнуть в сети и оставаться незамеченными. В этой статье мы подробно рассмотрим ряд
        продвинутых техник обхода IDS/IPS, подкрепленных практическими примерами из CTF (Capture The Flag) соревнований,
        результатами последних исследований в области кибербезопасности и анализом механизмов обфускации, полиморфного
        кода и фрагментации.
 </p>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Техники обхода IDS/IPS
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   1. Обфускация и полиморфизм
  </h3>
 </div>
 <p dir="auto">
  Описание: Обфускация и полиморфизм — это техники, используемые для скрытия вредоносного кода путем
        изменения его внешнего вида, не изменяя при этом его функциональность. Обфускация предполагает изменение кода
        таким образом, чтобы его было трудно понять и анализировать, в то время как полиморфизм предполагает изменение
        кода при каждом запуске, чтобы избежать обнаружения на основе сигнатур.
        Пример:
        • Использование различных техник кодирования, таких как base64, URL-кодирование и шестнадцатеричное кодирование,
        для маскировки вредоносного кода.
        • Изменение порядка инструкций, добавление случайных NOP-инструкций и использование эквивалентных инструкций для
        изменения внешнего вида кода.
        • Шифрование полезной нагрузки с использованием различных ключей и алгоритмов шифрования при каждом запуске.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   2. Кодирование и шифрование
  </h3>
 </div>
 <p dir="auto">
  Описание: Кодирование и шифрование используются для маскировки вредоносной полезной нагрузки, чтобы ее
        было трудно обнаружить IDS/IPS. Кодирование преобразует данные в другой формат, в то время как шифрование
        использует алгоритмы для защиты данных от несанкционированного доступа.
        Пример:
        • Использование кодировок, таких как base64, URL-кодирование и шестнадцатеричное кодирование, для маскировки
        вредоносных команд и URL-адресов.
        • Шифрование вредоносной полезной нагрузки с использованием алгоритмов, таких как AES, DES и RSA.
        • Использование протоколов шифрования, таких как TLS/SSL и SSH, для защиты трафика от анализа.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   3. Фрагментация и перекрытие фрагментов
  </h3>
 </div>
 <p dir="auto">
  Описание: Фрагментация и перекрытие фрагментов — это техники, используемые для разделения вредоносного
        трафика на мелкие части, которые отправляются по сети отдельно. Это затрудняет для IDS/IPS сборку полной картины
        трафика и обнаружение вредоносной активности.
        Пример:
        • Разделение TCP-пакета на несколько IP-фрагментов, которые отправляются по сети отдельно.
        • Перекрытие фрагментов, чтобы IDS/IPS не мог правильно собрать пакет.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   4. Time-to-Live (TTL) Manipulation
  </h3>
 </div>
 <p dir="auto">
  Описание: Time-to-Live (TTL) — это поле в IP-заголовке, которое указывает максимальное количество
        хопов, которые пакет может пройти, прежде чем он будет отброшен. Манипулирование TTL может быть использовано для
        обхода IDS/IPS путем отправки пакетов с низким TTL, которые достигают IDS/IPS, но не достигают целевой системы.
        Пример:
        • Отправка пакета с низким TTL на IDS/IPS, чтобы он был проанализирован, но не достиг целевой системы.
        • Отправка вредоносной полезной нагрузки в нескольких пакетах, один из которых имеет низкий TTL и достигает
        IDS/IPS, в то время как остальные пакеты имеют высокий TTL и достигают целевой системы.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   5. DoS-атаки и флуд
  </h3>
 </div>
 <p dir="auto">
  Описание: Атаки типа "отказ в обслуживании" (DoS) и флуд используются для перегрузки IDS/IPS большим
        количеством трафика, что затрудняет обнаружение реальных угроз.
        Пример:
        • Отправка большого количества запросов на IDS/IPS, чтобы перегрузить его и предотвратить обнаружение
        вредоносной активности.
        • Заполнение журналов IDS/IPS ложными срабатываниями, чтобы скрыть реальные атаки.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   6. Уклонение от фильтров веб-приложений (WAF)
  </h3>
 </div>
 <p dir="auto">
  Описание: Веб-приложения часто защищаются с помощью Web Application Firewalls (WAFs), которые
        фильтруют вредоносные запросы. Злоумышленники используют различные методы для обхода WAF, такие как:
        • Изменение регистра символов: Использование смешанного регистра символов для обхода фильтров, чувствительных к
        регистру.
        • Использование альтернативных представлений символов: Использование URL-кодирования, шестнадцатеричного
        кодирования и Unicode-символов для представления вредоносных символов.
        • Разделение вредоносного запроса на несколько частей: Отправка вредоносной полезной нагрузки в нескольких
        запросах, чтобы WAF не мог ее обнаружить.
        • Использование известных уязвимостей WAF: Эксплуатация известных уязвимостей WAF для обхода его защиты.
 </p>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   7. Использование протоколов, не проверяемых IDS
  </h3>
 </div>
 <p dir="auto">
  Описание: Злоумышленники могут использовать протоколы, которые не анализируются IDS, для отправки
        вредоносной полезной нагрузки.
        Пример:
        • Использование протоколов, таких как ICMP (Internet Control Message Protocol) или DNS (Domain Name System), для
        отправки вредоносного кода.
        • Туннелирование трафика через протокол, не проверяемый IDS, например, через SSH или VPN.
 </p>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Рекомендации по защите от техник обхода IDS/IPS
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   1. Регулярное обновление сигнатур:
  </h4>
 </div>
 <p dir="auto">
  Поддержание актуальных сигнатур позволяет обнаруживать известные угрозы.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   2. Использование анализа аномалий:
  </h4>
 </div>
 <p dir="auto">
  Анализ аномалий позволяет выявлять необычное поведение, которое может указывать на новые атаки.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   3. Интеграция с SIEM-системами:
  </h4>
 </div>
 <p dir="auto">
  Интеграция IDS/IPS с SIEM-системами позволяет анализировать данные из разных источников и выявлять
        сложные атаки.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   4. Мониторинг и анализ трафика:
  </h4>
 </div>
 <p dir="auto">
  Постоянный мониторинг и анализ трафика позволяют выявлять аномалии и подозрительную активность.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   5. Обучение персонала:
  </h4>
 </div>
 <p dir="auto">
  Обучение персонала позволяет выявлять и реагировать на угрозы.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   6. Использование TLS/SSL Interception:
  </h4>
 </div>
 <p dir="auto">
  Использование TLS/SSL Interception для анализа зашифрованного трафика (с учетом политик
        конфиденциальности).
 </p>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Заключение
  </h2>
 </div>
 <p dir="auto">
  Обход IDS/IPS систем — это сложная и постоянно развивающаяся область кибербезопасности. Злоумышленники
        используют различные методы для обхода обнаружения, и понимание этих методов является ключевым для защиты сетей.
        Задачи CTF помогают оттачивать навыки и понимать, как работают эти техники на практике. Постоянное обновление
        знаний и использование передовых методов защиты позволяют снизить риск успешных атак и обеспечить безопасность
        сети.
 </p>
</article>
