<article class="markdown-body entry-content container-lg" itemprop="text">
 <div class="markdown-heading" dir="auto">
  <h1 class="heading-element" dir="auto" tabindex="-1">
   Тестирование почтовых протоколов SMTP, POP3, IMAP
  </h1>
 </div>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Введение
  </h2>
 </div>
 <p dir="auto">
  Электронная почта — важный инструмент связи, который широко используется в современном мире. Однако,
        как и любая другая технология, протоколы, обеспечивающие её работу, могут иметь уязвимости. Эти уязвимости часто
        используются злоумышленниками для атак, поэтому изучение, тестирование и защита этих протоколов имеет ключевое
        значение, особенно в контексте информационной безопасности и CTF (Capture The Flag) задач.
  <a href="https://private-user-images.githubusercontent.com/146094679/399164689-6372a55c-5a6e-4b08-a4e8-ff3ff963ec7b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0Njg5LTYzNzJhNTVjLTVhNmUtNGIwOC1hNGU4LWZmM2ZmOTYzZWM3Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02NzliMGNmNmJlNDQ4ZjEzNTY2YTk4MDAxYjhhMWM4OWIyNWIyYzljMmY3MmY1MmY2MjBjYzVlODliOTQzMWRkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.jYAefCLabsjek9xTuaeTO8VCcpD9qfXsx4LbtRePMEU" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164689-6372a55c-5a6e-4b08-a4e8-ff3ff963ec7b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0Njg5LTYzNzJhNTVjLTVhNmUtNGIwOC1hNGU4LWZmM2ZmOTYzZWM3Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02NzliMGNmNmJlNDQ4ZjEzNTY2YTk4MDAxYjhhMWM4OWIyNWIyYzljMmY3MmY1MmY2MjBjYzVlODliOTQzMWRkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.jYAefCLabsjek9xTuaeTO8VCcpD9qfXsx4LbtRePMEU" style="max-width: 100%;"/>
  </a>
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   1. Описание почтовых протоколов
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   SMTP (Simple Mail Transfer Protocol)
  </h3>
 </div>
 <p dir="auto">
  SMTP — это протокол, используемый для отправки электронной почты. Он работает на уровне приложения и
        использует TCP порт 25 (или 587 для защищённых соединений).
  <a href="https://private-user-images.githubusercontent.com/146094679/399164418-01c1322b-2299-4465-a3c6-2ee658b09305.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0NDE4LTAxYzEzMjJiLTIyOTktNDQ2NS1hM2M2LTJlZTY1OGIwOTMwNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hY2EzMDY3MDg1NTlhNzAwNjk5NmFlNzczMTQ0MjczMDI0OTY1NjdhMzVlNmZlMThhN2QwZWU1ZjI5MWJjZTg1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.3XxG1BVjRX1Y011tZzrGOJ4ggdMzP9a5NX_XDTHyL5Q" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164418-01c1322b-2299-4465-a3c6-2ee658b09305.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0NDE4LTAxYzEzMjJiLTIyOTktNDQ2NS1hM2M2LTJlZTY1OGIwOTMwNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hY2EzMDY3MDg1NTlhNzAwNjk5NmFlNzczMTQ0MjczMDI0OTY1NjdhMzVlNmZlMThhN2QwZWU1ZjI5MWJjZTg1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.3XxG1BVjRX1Y011tZzrGOJ4ggdMzP9a5NX_XDTHyL5Q" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  <strong>
   Ключевые особенности:
  </strong>
 </p>
 <ul dir="auto">
  <li>
   Основной протокол для передачи почты между серверами.
  </li>
  <li>
   Возможность добавления расширений (например, SMTP AUTH для аутентификации).
  </li>
  <li>
   Использует простой текст для команд и сообщений.
  </li>
 </ul>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Подключение
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Подключение через Telnet
  </h4>
 </div>
 <p dir="auto">
  Telnet можно использовать для подключения к удалённому серверу с помощью команды:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>telnet example.com 25</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Перечисление
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Определение SMTP-сервера
  </h4>
 </div>
 <p dir="auto">
  Для проверки наличия SMTP-сервера на целевом хосте можно использовать Nmap:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -p25,465,587 -sV -Pn target.com</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Перечисление пользователей
  </h4>
 </div>
 <p dir="auto">
  Nmap имеет скрипт для перечисления пользователей SMTP:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -p25 --script smtp-enum-users.nse target.com</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Перечисление записей DNS MX
  </h4>
 </div>
 <p dir="auto">
  Для нахождения почтовых серверов (MX) домена можно использовать утилиту dig:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>dig +short mx example.com</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Раскрытие информации с NTLM-аутентификацией
  </h4>
 </div>
 <p dir="auto">
  Некоторые SMTP-серверы с включённой NTLM-аутентификацией могут раскрывать конфиденциальную информацию,
        например версию Windows Server и внутренний IP:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -p25 --script smtp-ntlm-info --script-args smtp-ntlm-info.fingerprint=on target.com</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Вектор атак
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Уязвимость Open Relay
  </h4>
 </div>
 <p dir="auto">
  Open Relay позволяет серверу принимать и пересылать сообщения, не предназначенные для локальных
        пользователей. Для проверки:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>telnet target.com 25
    MAIL FROM:<span class="pl-k">&lt;</span>test@example.com<span class="pl-k">&gt;</span>
    RCPT TO:<span class="pl-k">&lt;</span>test2@anotherexample.com<span class="pl-k">&gt;</span>
    DATA
    Subject: Test open relay
    Test message
    <span class="pl-c1">.</span>
    QUIT</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Постэксплуатация
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Общие команды SMTP
  </h4>
 </div>
 <markdown-accessiblity-table data-catalyst="">
  <table>
   <thead>
    <tr>
     <th>
      Команда
     </th>
     <th>
      Описание
     </th>
     <th>
      Пример
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      HELO
     </td>
     <td>
      Идентифицирует клиента серверу.
     </td>
     <td>
      <code>
       HELO example.com
      </code>
     </td>
    </tr>
    <tr>
     <td>
      EHLO
     </td>
     <td>
      Расширенное приветствие.
     </td>
     <td>
      <code>
       EHLO example.com
      </code>
     </td>
    </tr>
    <tr>
     <td>
      MAIL FROM:
     </td>
     <td>
      Указывает адрес отправителя.
     </td>
     <td>
      <code>
       MAIL FROM:&lt;sender@example.com&gt;
      </code>
     </td>
    </tr>
    <tr>
     <td>
      RCPT TO:
     </td>
     <td>
      Указывает адрес получателя.
     </td>
     <td>
      <code>
       RCPT TO:&lt;recipient@example.com&gt;
      </code>
     </td>
    </tr>
    <tr>
     <td>
      DATA
     </td>
     <td>
      Начало тела сообщения.
     </td>
     <td>
      <code>
       DATA
      </code>
     </td>
    </tr>
    <tr>
     <td>
      RSET
     </td>
     <td>
      Сбрасывает сессию.
     </td>
     <td>
      <code>
       RSET
      </code>
     </td>
    </tr>
    <tr>
     <td>
      NOOP
     </td>
     <td>
      Без операции, используется для тестирования.
     </td>
     <td>
      <code>
       NOOP
      </code>
     </td>
    </tr>
    <tr>
     <td>
      QUIT
     </td>
     <td>
      Завершает сессию.
     </td>
     <td>
      <code>
       QUIT
      </code>
     </td>
    </tr>
   </tbody>
  </table>
 </markdown-accessiblity-table>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   POP3 (Post Office Protocol v3)
  </h3>
 </div>
 <p dir="auto">
  POP3 — это протокол для получения электронной почты с сервера. Работает на порту 110 (или 995 для
        SSL/TLS).
  <a href="https://private-user-images.githubusercontent.com/146094679/399164479-01a21c31-0d14-4179-894d-13f927a53aff.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0NDc5LTAxYTIxYzMxLTBkMTQtNDE3OS04OTRkLTEzZjkyN2E1M2FmZi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mYTRlZWE1YWMzNDA2Y2IyZTI5ZjliYzkwMjVjMDI4OGU1NTdhODlmMjI1Y2Q5YmU1YTk1M2MyMTAyYWNkNTcwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.OJ7x7teX77fl7wnHIxLJS_I0QugYpHIEVpKh5HOWISE" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164479-01a21c31-0d14-4179-894d-13f927a53aff.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0NDc5LTAxYTIxYzMxLTBkMTQtNDE3OS04OTRkLTEzZjkyN2E1M2FmZi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mYTRlZWE1YWMzNDA2Y2IyZTI5ZjliYzkwMjVjMDI4OGU1NTdhODlmMjI1Y2Q5YmU1YTk1M2MyMTAyYWNkNTcwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.OJ7x7teX77fl7wnHIxLJS_I0QugYpHIEVpKh5HOWISE" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  <strong>
   Ключевые особенности:
  </strong>
 </p>
 <ul dir="auto">
  <li>
   Предназначен для загрузки писем с сервера на локальное устройство.
  </li>
  <li>
   Удаляет письма с сервера после загрузки (по умолчанию).
  </li>
  <li>
   Ограниченная функциональность (нет синхронизации между устройствами).
  </li>
 </ul>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Подключение
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Ручное подключение
  </h4>
 </div>
 <p dir="auto">
  Для подключения можно использовать Netcat:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nc <span class="pl-k">&lt;</span>target-ip<span class="pl-k">&gt;</span> 110</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Подключение через OpenSSL
  </h4>
 </div>
 <p dir="auto">
  Для тестирования защищённого соединения POP3:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>openssl s_client -connect <span class="pl-k">&lt;</span>ip<span class="pl-k">&gt;</span>:995</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Распознавание
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Сбор баннеров
  </h4>
 </div>
 <p dir="auto">
  Для получения баннера:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nc <span class="pl-k">&lt;</span>target-ip<span class="pl-k">&gt;</span> 110</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Получение информации через Nmap
  </h4>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -p 110 --script pop3-capabilities <span class="pl-k">&lt;</span>ip<span class="pl-k">&gt;</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Перечисление
  </h3>
 </div>
 <p dir="auto">
  Использование скрипта для сбора информации:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -p 110 --script pop3-ntlm-info <span class="pl-k">&lt;</span>ip<span class="pl-k">&gt;</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Вектор атак
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Брутфорс
  </h4>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Nmap
  </h5>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -p 110 --script pop3-brute --script-args userdb=users.txt,passdb=pass.txt <span class="pl-k">&lt;</span>ip<span class="pl-k">&gt;</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Hydra
  </h5>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>hydra -L <span class="pl-k">&lt;</span>user list file<span class="pl-k">&gt;</span> -P <span class="pl-k">&lt;</span>password list file<span class="pl-k">&gt;</span> -f <span class="pl-k">&lt;</span>ip<span class="pl-k">&gt;</span> pop3 -V</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Постэксплуатация
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Извлечение писем
  </h4>
 </div>
 <p dir="auto">
  Для чтения писем используйте команду:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>RETR 1</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Удаление писем
  </h4>
 </div>
 <p dir="auto">
  Для удаления письма:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>DELE 1</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Проверка на наличие учётных данных
  </h4>
 </div>
 <p dir="auto">
  Изучите содержимое писем на наличие логинов и паролей.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Поиск конфиденциальных данных
  </h4>
 </div>
 <p dir="auto">
  В письмах могут содержаться личные, финансовые или корпоративные секреты.
 </p>
 <p dir="auto">
  <strong>
   Примеры команд POP3:
  </strong>
 </p>
 <ul dir="auto">
  <li>
   USER — указание имени пользователя.
  </li>
  <li>
   PASS — ввод пароля.
  </li>
  <li>
   LIST — список сообщений.
  </li>
  <li>
   RETR — получение сообщения.
  </li>
  <li>
   DELE — удаление сообщения.
  </li>
 </ul>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   IMAP (Internet Message Access Protocol)
  </h3>
 </div>
 <p dir="auto">
  IMAP — это протокол для доступа к электронной почте, который работает на порту 143 (или 993 для
        SSL/TLS).
  <a href="https://private-user-images.githubusercontent.com/146094679/399164233-939f7e93-dd46-4269-a1f3-cd97882da88a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MjMzLTkzOWY3ZTkzLWRkNDYtNDI2OS1hMWYzLWNkOTc4ODJkYTg4YS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zM2QyNGFjNGFkMmRkMGRkOWU5NGNmMjk0YzE3ZjgxYzc1OGZjNzJjZGEzMTFjZDU4NTY5NTViNDlmNDg3ZTUzJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.NuxEw-mkV7exg5O11QqfANABz_PoDWGxkPfCONONyuE" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164233-939f7e93-dd46-4269-a1f3-cd97882da88a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MjMzLTkzOWY3ZTkzLWRkNDYtNDI2OS1hMWYzLWNkOTc4ODJkYTg4YS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zM2QyNGFjNGFkMmRkMGRkOWU5NGNmMjk0YzE3ZjgxYzc1OGZjNzJjZGEzMTFjZDU4NTY5NTViNDlmNDg3ZTUzJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.NuxEw-mkV7exg5O11QqfANABz_PoDWGxkPfCONONyuE" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  <strong>
   Ключевые особенности:
  </strong>
 </p>
 <ul dir="auto">
  <li>
   Поддержка работы с почтой на сервере без необходимости её загрузки.
  </li>
  <li>
   Возможность работы с папками, поиска и фильтрации сообщений.
  </li>
  <li>
   Синхронизация между устройствами.
  </li>
 </ul>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Подключение
  </h4>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Подключение через Telnet
  </h5>
 </div>
 <p dir="auto">
  Для подключения к серверу IMAP используйте:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>telnet <span class="pl-k">&lt;</span>server-ip<span class="pl-k">&gt;</span> <span class="pl-k">&lt;</span>port<span class="pl-k">&gt;</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Подключение через почтовые клиенты
  </h5>
 </div>
 <p dir="auto">
  Для работы с IMAP можно использовать почтовые клиенты, такие как Outlook, Thunderbird или Apple Mail.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Распознавание
  </h4>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Определение IMAP-сервера
  </h5>
 </div>
 <p dir="auto">
  Сканирование с помощью Nmap:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -p 143,993 <span class="pl-k">&lt;</span>target-ip<span class="pl-k">&gt;</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Сбор баннеров
  </h5>
 </div>
 <p dir="auto">
  Получение баннера с помощью Telnet:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>telnet <span class="pl-k">&lt;</span>server-ip<span class="pl-k">&gt;</span> <span class="pl-k">&lt;</span>port<span class="pl-k">&gt;</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Перечисление
  </h4>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Перечисление почтовых ящиков
  </h5>
 </div>
 <p dir="auto">
  Для получения списка почтовых ящиков:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>LIST <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span> <span class="pl-k">*</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Перечисление заголовков писем
  </h5>
 </div>
 <p dir="auto">
  Получение заголовков письма:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>FETCH 1 BODY[HEADER.FIELDS (FROM TO SUBJECT DATE)]</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Вектор атак
  </h4>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Брутфорс
  </h5>
 </div>
 <div class="markdown-heading" dir="auto">
  <h6 class="heading-element" dir="auto" tabindex="-1">
   Hydra
  </h6>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>hydra -L users.txt -P passwords.txt imap://<span class="pl-k">&lt;</span>server-ip<span class="pl-k">&gt;</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Nmap
  </h5>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap --script imap-brute -p 143,993 <span class="pl-k">&lt;</span>target-ip<span class="pl-k">&gt;</span></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   IMAP-инъекции
  </h5>
 </div>
 <p dir="auto">
  Используются для эксплуатации уязвимостей серверного ПО.
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Атаки «человек посередине» (MitM)
  </h5>
 </div>
 <p dir="auto">
  MitM-атаки на IMAP-трафик могут перехватывать и модифицировать сообщения.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Постэксплуатация
  </h4>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Извлечение почты
  </h5>
 </div>
 <p dir="auto">
  После получения доступа к аккаунту можно извлечь конфиденциальную информацию.
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Манипуляции с письмами
  </h5>
 </div>
 <p dir="auto">
  Удаление, пересылка или изменение писем для достижения целей.
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Настройка переадресации
  </h5>
 </div>
 <p dir="auto">
  Установка правил пересылки для отправки входящих сообщений на сторонний адрес.
 </p>
 <p dir="auto">
  <strong>
   Примеры команд IMAP:
  </strong>
 </p>
 <ul dir="auto">
  <li>
   LOGIN — аутентификация пользователя.
  </li>
  <li>
   SELECT — выбор почтового ящика.
  </li>
  <li>
   FETCH — получение сообщений.
  </li>
  <li>
   STORE — изменение флагов сообщений.
  </li>
  <li>
   LOGOUT — завершение сеанса.
  </li>
 </ul>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Другие протоколы
  </h3>
 </div>
 <ul dir="auto">
  <li>
   <strong>
    MIME (Multipurpose Internet Mail Extensions)
   </strong>
   — стандарт для передачи мультимедийных
            сообщений.
  </li>
  <li>
   <strong>
    ESMTP (Extended SMTP)
   </strong>
   — расширение для SMTP, добавляющее поддержку дополнительных функций
            (например, авторизация).
  </li>
  <li>
   <strong>
    LMTP (Local Mail Transfer Protocol)
   </strong>
   — оптимизированный протокол для локальных серверов.
  </li>
 </ul>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   2. Уязвимости почтовых протоколов
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Общие уязвимости
  </h3>
 </div>
 <ol dir="auto">
  <li>
   <p dir="auto">
    <strong>
     Проблемы с аутентификацией:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Отсутствие обязательного использования шифрования (например, отправка паролей в открытом виде).
    </li>
    <li>
     Устаревшие методы авторизации (PLAIN, LOGIN).
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Man-in-the-Middle (MITM) атаки:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Возможность перехвата данных при отсутствии шифрования (SMTP без STARTTLS, IMAP/POP3 без SSL/TLS).
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Ошибки в конфигурации серверов:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Открытые релееры SMTP (Open Relay), позволяющие отправлять спам.
    </li>
    <li>
     Неправильное управление доступом к почтовым ящикам.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Атаки на протоколы:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Командные инъекции (например, подмена команды HELO).
    </li>
    <li>
     Эксплуатация переполнения буфера.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Социальная инженерия и фишинг:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Использование фальсифицированных заголовков в письмах.
    </li>
    <li>
     Отправка поддельных сообщений с легитимных серверов через плохо настроенные SMTP.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Подбор паролей через слабую защиту от брутфорса
    </strong>
   </p>
  </li>
 </ol>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Cпецифичные уязвимости протоколов
  </h3>
 </div>
 <ul dir="auto">
  <li>
   <p dir="auto">
    <strong>
     SMTP:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Подмена отправителя (Email Spoofing) - Отсутствие проверки подлинности отправителя позволяет
                    злоумышленникам отправлять письма от имени доверенных лиц.
    </li>
    <li>
     Открытые релееры (Open Relay) - Серверы, неправильно настроенные для проверки отправителя, позволяют
                    пересылать почту от любого отправителя к любому получателю, что используется для спама и фишинга.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     POP3:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Перехват учетных данных при отсутствии SSL/TLS.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     IMAP:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Уязвимости в серверах IMAP, позволяющие выполнение произвольного кода.
    </li>
    <li>
     IMAP-инъекции - Внедрение вредоносных команд через специально сформированные запросы может привести
                    к несанкционированному доступу или утечке данных
    </li>
   </ul>
  </li>
 </ul>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   3. Задачи в CTF
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   SMTP
  </h3>
 </div>
 <ol dir="auto">
  <li>
   <p dir="auto">
    <strong>
     Email Spoofing:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Найти и использовать открытую SMTP-конфигурацию для отправки поддельных писем.
    </li>
    <li>
     Подделать заголовки письма для обхода фильтров.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Анализ SMTP трафика:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Исследовать перехваченный дамп трафика, чтобы извлечь данные (учетные записи, команды).
    </li>
   </ul>
  </li>
 </ol>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   POP3
  </h3>
 </div>
 <ol dir="auto">
  <li>
   <p dir="auto">
    <strong>
     Перехват учетных данных:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Декодировать логины и пароли, переданные в незашифрованном виде.
    </li>
    <li>
     Анализировать данные для восстановления писем.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Извлечение вложений:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Восстановить файл, переданный через MIME.
    </li>
   </ul>
  </li>
 </ol>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   IMAP
  </h3>
 </div>
 <ol dir="auto">
  <li>
   <p dir="auto">
    <strong>
     Синхронизация писем:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Выполнить аутентификацию и получить доступ к почтовым ящикам.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Брутфорс:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Найти учетные данные для доступа к серверу.
    </li>
   </ul>
  </li>
 </ol>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Примеры задач
  </h3>
 </div>
 <ul dir="auto">
  <li>
   Найти пароль в заголовках письма.
  </li>
  <li>
   Извлечь флаг, скрытый в закодированном содержимом письма (Base64, quoted-printable).
  </li>
  <li>
   Перехватить и декодировать данные протоколов.
  </li>
 </ul>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   4. Как готовиться и решать задачи
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Инструменты для тестирования
  </h3>
 </div>
 <ol dir="auto">
  <li>
   <p dir="auto">
    <strong>
     Wireshark:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Анализ трафика SMTP, POP3, IMAP.
    </li>
    <li>
     Фильтрация по портам и декодирование содержимого.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Telnet и Netcat:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Ручное тестирование SMTP, POP3, IMAP.
    </li>
    <li>
     Отправка и получение сообщений.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Python скрипты:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Использование библиотек
     <code>
      smtplib
     </code>
     ,
     <code>
      imaplib
     </code>
     ,
     <code>
      poplib
     </code>
     для
                    автоматизации работы.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Burp Suite:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Перехват HTTPS трафика почтовых клиентов.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Nmap:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Сканирование портов и выполнение скриптов для обнаружения уязвимостей в почтовых сервисах.
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Hydra:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Инструмент для проведения брутфорс-атак на почтовые сервисы.
    </li>
   </ul>
  </li>
 </ol>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   5. Pentest SMTP, IMAP, POP3
  </h2>
 </div>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Пентест SMTP-сервера
  </h3>
 </div>
 <p dir="auto">
  Команда EXPN раскрывает реальные адреса псевдонимов пользователей и списков рассылки, а VRFY может
        подтвердить существование имён действительных пользователей.
 </p>
 <p dir="auto">
  Перечисление через SMTP можно выполнить вручную с помощью таких утилит, как
  <code>
   telnet
  </code>
  и
  <code>
   netcat
  </code>
  , или автоматически, используя различные инструменты, такие как
  <code>
   metasploit
  </code>
  ,
  <code>
   nmap
  </code>
  и
  <code>
   smtp-user-enum
  </code>
  . На следующих двух скриншотах показано, как можно перечислять
        пользователей с помощью команд VRFY и RCPT через службу Telnet.
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Перечисление пользователей SMTP через Telnet
  </h4>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399163700-0e607c60-85c6-4257-a340-14c9eaaecf6c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzAwLTBlNjA3YzYwLTg1YzYtNDI1Ny1hMzQwLTE0YzllYWFlY2Y2Yy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1kNWM1ZmYxZWI2MDkzZmVkYzZkNTE1MDk2YmFhMzhmMTA4YmQ0ZjU4YjE0MzVmYzU0NjI4MjdkY2IyNjA2NDMyJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.BxAV4JoDvSHQntedgX4PwbBrIE0JMjpk5bp7jOp-Imc" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399163700-0e607c60-85c6-4257-a340-14c9eaaecf6c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzAwLTBlNjA3YzYwLTg1YzYtNDI1Ny1hMzQwLTE0YzllYWFlY2Y2Yy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1kNWM1ZmYxZWI2MDkzZmVkYzZkNTE1MDk2YmFhMzhmMTA4YmQ0ZjU4YjE0MzVmYzU0NjI4MjdkY2IyNjA2NDMyJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.BxAV4JoDvSHQntedgX4PwbBrIE0JMjpk5bp7jOp-Imc" style="max-width: 100%;"/>
  </a>
 </p>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Перечисление пользователей с помощью команды RCPT
  </h4>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399163724-9fd3f607-e1ff-40e5-aadb-552d1282b0d3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzI0LTlmZDNmNjA3LWUxZmYtNDBlNS1hYWRiLTU1MmQxMjgyYjBkMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05YTg4OTBkYjllOTFmYjcyZDBhYzk1YmY1ZWEzNmUwNDU0ZTFjNzJlMjNkNGJkMDk1Y2E0ZmE0NWQzYWE3OTI2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.thla8TBY4NdMDIHz61j4ezeI-awmyHT1D9IvbkI_j0s" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399163724-9fd3f607-e1ff-40e5-aadb-552d1282b0d3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzI0LTlmZDNmNjA3LWUxZmYtNDBlNS1hYWRiLTU1MmQxMjgyYjBkMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05YTg4OTBkYjllOTFmYjcyZDBhYzk1YmY1ZWEzNmUwNDU0ZTFjNzJlMjNkNGJkMDk1Y2E0ZmE0NWQzYWE3OTI2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.thla8TBY4NdMDIHz61j4ezeI-awmyHT1D9IvbkI_j0s" style="max-width: 100%;"/>
  </a>
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Metasploit
  </h4>
 </div>
 <p dir="auto">
  Модуль, который может выполнять перечисление пользователей через SMTP в Metasploit Framework:
 </p>
 <div class="snippet-clipboard-content notranslate position-relative overflow-auto">
  <pre class="notranslate"><code>auxiliary/scanner/smtp/smtp_enum
    </code></pre>
 </div>
 <p dir="auto">
  Единственное, что требуется этому модулю, — это указать IP-адрес удалённого хоста и выполнить команду
  <code>
   run
  </code>
  , так как остальные параметры автоматически заполняются Metasploit.
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Конфигурация модуля Metasploit для перечисления SMTP
  </h5>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399163746-ad8a389e-7130-4a89-8bce-e682ea8cdf5f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzQ2LWFkOGEzODllLTcxMzAtNGE4OS04YmNlLWU2ODJlYThjZGY1Zi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xZWU2ZDg5MTkzNmNiMTNkYTc2NzdhZjI0ZmZkMGQ2YzI4ODQ4MGJmNmNiOGIzYmQ5ODg3MTA5Yjk1M2VkODg5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.Rr1HgWzdPp4sFSo3kw26aHjsySImET2CZkIGs5nIbRg" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399163746-ad8a389e-7130-4a89-8bce-e682ea8cdf5f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzQ2LWFkOGEzODllLTcxMzAtNGE4OS04YmNlLWU2ODJlYThjZGY1Zi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xZWU2ZDg5MTkzNmNiMTNkYTc2NzdhZjI0ZmZkMGQ2YzI4ODQ4MGJmNmNiOGIzYmQ5ODg3MTA5Yjk1M2VkODg5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.Rr1HgWzdPp4sFSo3kw26aHjsySImET2CZkIGs5nIbRg" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  Результаты работы Metasploit показаны на следующем изображении:
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Результаты перечисления пользователей через Metasploit
  </h5>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399163757-6cb82250-35b5-4531-8421-e478b3e15d33.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzU3LTZjYjgyMjUwLTM1YjUtNDUzMS04NDIxLWU0NzhiM2UxNWQzMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1kZjJmZTA4OGNkNTAxNjhkZTEyNmExNTI5NDEyMmY2OTU2Yzk4ODUwMTRjOTk4ZjY4ZmZhMGZhYWVhMjBjNjZjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.CyWxgyYPT5qXT9taiBu0_q-U6g7R6B3o2_dV5txJ5pk" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399163757-6cb82250-35b5-4531-8421-e478b3e15d33.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzU3LTZjYjgyMjUwLTM1YjUtNDUzMS04NDIxLWU0NzhiM2UxNWQzMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1kZjJmZTA4OGNkNTAxNjhkZTEyNmExNTI5NDEyMmY2OTU2Yzk4ODUwMTRjOTk4ZjY4ZmZhMGZhYWVhMjBjNjZjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.CyWxgyYPT5qXT9taiBu0_q-U6g7R6B3o2_dV5txJ5pk" style="max-width: 100%;"/>
  </a>
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   smtp-user-enum
  </h4>
 </div>
 <p dir="auto">
  Ещё один инструмент, который можно использовать, — это
  <code>
   smtp-user-enum
  </code>
  , предоставляющий
        три метода перечисления пользователей. Команды, используемые этим инструментом для проверки имён пользователей:
  <code>
   EXPN
  </code>
  ,
  <code>
   VRFY
  </code>
  и
  <code>
   RCPT
  </code>
  . Он также поддерживает проверку одного имени
        пользователя или нескольких через
  <code>
   .txt
  </code>
  -файл. Чтобы эффективно использовать этот инструмент, вам
        понадобится хороший список имён пользователей. Пример сканирования с использованием команды VRFY, который
        обнаружил следующие имена пользователей:
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Перечисление пользователей SMTP с помощью smtp-user-enum
  </h5>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399163768-144fd3fe-0893-42e6-9649-edb9df53ee65.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzY4LTE0NGZkM2ZlLTA4OTMtNDJlNi05NjQ5LWVkYjlkZjUzZWU2NS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00MmQ1NTBjZDJkMTM2ZmFkMjE2ZGVjYjdiYWY4NTAwYmU5YmM2YThmNmFhYzhmNGM5ZTMyYTI3MjQxYTQwN2VjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.OaOQRJz0Pt03U7zGOC4cMtyipa9lYwYD0Dn618CPYFw" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399163768-144fd3fe-0893-42e6-9649-edb9df53ee65.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzY4LTE0NGZkM2ZlLTA4OTMtNDJlNi05NjQ5LWVkYjlkZjUzZWU2NS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00MmQ1NTBjZDJkMTM2ZmFkMjE2ZGVjYjdiYWY4NTAwYmU5YmM2YThmNmFhYzhmNGM5ZTMyYTI3MjQxYTQwN2VjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.OaOQRJz0Pt03U7zGOC4cMtyipa9lYwYD0Dn618CPYFw" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  Инструмент также может использоваться для обнаружения действительных email-адресов вместо имён
        пользователей. Следующее изображение иллюстрирует это использование:
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Обнаружение email-адресов через smtp-user-enum
  </h5>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399163773-985b5325-e714-4b22-9c79-b8eace24704b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzczLTk4NWI1MzI1LWU3MTQtNGIyMi05Yzc5LWI4ZWFjZTI0NzA0Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wZWJmNWMzY2ZhNjI4NmYxNzQzM2VmY2RkMmNjZDUwMjE0NmY0MWRkMTRjY2NkMTc3NjIwMDY3MzQwOTY2MDI1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.KxGJIUxZOkMez0FsnkeQKk23GwEMzDz3NI0yIxxAFsM" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399163773-985b5325-e714-4b22-9c79-b8eace24704b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzczLTk4NWI1MzI1LWU3MTQtNGIyMi05Yzc5LWI4ZWFjZTI0NzA0Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wZWJmNWMzY2ZhNjI4NmYxNzQzM2VmY2RkMmNjZDUwMjE0NmY0MWRkMTRjY2NkMTc3NjIwMDY3MzQwOTY2MDI1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.KxGJIUxZOkMez0FsnkeQKk23GwEMzDz3NI0yIxxAFsM" style="max-width: 100%;"/>
  </a>
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Nmap
  </h4>
 </div>
 <p dir="auto">
  Перечисление SMTP также можно выполнить с помощью Nmap. В движке NSE (Nmap Scripting Engine) есть
        скрипт для перечисления пользователей SMTP. Основное использование скрипта выглядит так:
 </p>
 <div class="snippet-clipboard-content notranslate position-relative overflow-auto">
  <pre class="notranslate"><code>nmap –script smtp-enum-users.nse 172.16.212.133
    </code></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Перечисление имён пользователей SMTP через Nmap
  </h5>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399163794-ea390a32-7cdc-40d0-aa45-84574507cda5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzk0LWVhMzkwYTMyLTdjZGMtNDBkMC1hYTQ1LTg0NTc0NTA3Y2RhNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04NzZkYzhkYmU3NGY2ZDlhMGE5Nzc4YmYyZTg5NWY3NGVhZWE4MTQ3YzkwMGM0ZjFhOGQ5Y2Q3ZDdlZmQ1ZTU5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.oOA8DDhwKGymLPU-X6U24Zk9m4Ld4AzTa7m5_NyTTHw" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399163794-ea390a32-7cdc-40d0-aa45-84574507cda5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTYzNzk0LWVhMzkwYTMyLTdjZGMtNDBkMC1hYTQ1LTg0NTc0NTA3Y2RhNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04NzZkYzhkYmU3NGY2ZDlhMGE5Nzc4YmYyZTg5NWY3NGVhZWE4MTQ3YzkwMGM0ZjFhOGQ5Y2Q3ZDdlZmQ1ZTU5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.oOA8DDhwKGymLPU-X6U24Zk9m4Ld4AzTa7m5_NyTTHw" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  На приведённом изображении видно, что перечисление в этом случае не удалось.
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Вывод
  </h4>
 </div>
 <p dir="auto">
  SMTP — это общая служба, которая встречается в каждой сети. Администраторам необходимо правильно
        настраивать почтовые серверы, запрещая выполнение команд
  <code>
   EXPN
  </code>
  ,
  <code>
   VRFY
  </code>
  и
  <code>
   RCPT
  </code>
  , чтобы избежать утечки данных. С другой стороны, тестировщики на проникновение могут
        использовать имена пользователей, полученные через перечисление, для проведения дальнейших атак на другие
        системы.
 </p>
 <p dir="auto">
  Вот перевод и форматирование секций для IMAP и POP3:
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Лучшие практики пентеста IMAP
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   IMAP
  </h4>
 </div>
 <p dir="auto">
  IMAP обычно использует порты 143 и 993.
 </p>
 <hr/>
 <div class="snippet-clipboard-content notranslate position-relative overflow-auto">
  <pre class="notranslate"><code>PORT     STATE SERVICE               VERSION
    143/tcp  open  imap                  Dovecot imapd (Ubuntu)
    </code></pre>
 </div>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Пентест IMAP
  </h4>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Поиск с помощью Shodan:
  </h5>
 </div>
 <div class="snippet-clipboard-content notranslate position-relative overflow-auto">
  <pre class="notranslate"><code>port:143, 993  
    port:143 CAPABILITY  
    port:993 CAPABILITY  
    </code></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Захват баннеров:
  </h5>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre><span class="pl-c"><span class="pl-c">#</span> Захват баннеров и тест соединения</span>
    nc -nv IP 143
    A1 LOGIN “root” “”
    A1 LOGIN root toor
    A1 LOGIN root root</pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Примеры команд Nmap:
  </h5>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -p143 -sV --script=banner 192.168.x.x
    nmap -p143 --script=imap-ntlm-info 192.168.x.x
    msf <span class="pl-k">&gt;</span> use auxiliary/scanner/imap/imap_version
    openssl s_client -connect 192.168.x.x:993 -quiet
    telnet 192.168.x.x 143</pre>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399164002-2b62a4d7-a6a1-4f6f-aa12-c1196b8efbe0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MDAyLTJiNjJhNGQ3LWE2YTEtNGY2Zi1hYTEyLWMxMTk2YjhlZmJlMC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02NzM0ZDZkYTVmMmU1YjBlOWM1ZmY2NzE3NDQ5NzNkZmU1OTMxM2I0OWEwNzYwZjBkMTQ1MDRlYzkwNDBkYWE5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.v23H12khBMxdV8PoVlw_B4Lec39vPIMl1ehYEsm3b3E" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164002-2b62a4d7-a6a1-4f6f-aa12-c1196b8efbe0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MDAyLTJiNjJhNGQ3LWE2YTEtNGY2Zi1hYTEyLWMxMTk2YjhlZmJlMC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02NzM0ZDZkYTVmMmU1YjBlOWM1ZmY2NzE3NDQ5NzNkZmU1OTMxM2I0OWEwNzYwZjBkMTQ1MDRlYzkwNDBkYWE5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.v23H12khBMxdV8PoVlw_B4Lec39vPIMl1ehYEsm3b3E" style="max-width: 100%;"/>
  </a>
  <a href="https://private-user-images.githubusercontent.com/146094679/399164048-386a06ae-6d18-433e-90dd-e89e3f993da4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MDQ4LTM4NmEwNmFlLTZkMTgtNDMzZS05MGRkLWU4OWUzZjk5M2RhNC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05MTIwZDNkMTkzMjg2Njc0NWU1MDM1ZGI1NDY3MmNhNmVmODQ5MzBlNGMxOTYzMDA3MDZjZmE0N2ZiYmM5ZWNjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.ftadWSF8Z9IPqLwkCoF0MorhG2kEs9QxEUtCUfw4xDw" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164048-386a06ae-6d18-433e-90dd-e89e3f993da4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MDQ4LTM4NmEwNmFlLTZkMTgtNDMzZS05MGRkLWU4OWUzZjk5M2RhNC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05MTIwZDNkMTkzMjg2Njc0NWU1MDM1ZGI1NDY3MmNhNmVmODQ5MzBlNGMxOTYzMDA3MDZjZmE0N2ZiYmM5ZWNjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.ftadWSF8Z9IPqLwkCoF0MorhG2kEs9QxEUtCUfw4xDw" style="max-width: 100%;"/>
  </a>
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Определение возможностей сервера:
  </h5>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap -sV --script=imap-capabilities -p143 10.10.x.x</pre>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399164080-957aa9e4-9744-4c57-9067-08552d3c291d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MDgwLTk1N2FhOWU0LTk3NDQtNGM1Ny05MDY3LTA4NTUyZDNjMjkxZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1iZWM3NzdhNzk1NzMwOTE3M2QxOTQwYTRlNWZlMDkxMTJhZDc2MmYzZDRlMWRkYmE5NTQ0ZWRlM2IwNjQwYTA3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.DDPFIrOuEoSFRiiW9DxyXhsq4FlEJ0PK-MGM8KVWgXw" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164080-957aa9e4-9744-4c57-9067-08552d3c291d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MDgwLTk1N2FhOWU0LTk3NDQtNGM1Ny05MDY3LTA4NTUyZDNjMjkxZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1iZWM3NzdhNzk1NzMwOTE3M2QxOTQwYTRlNWZlMDkxMTJhZDc2MmYzZDRlMWRkYmE5NTQ0ZWRlM2IwNjQwYTA3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.DDPFIrOuEoSFRiiW9DxyXhsq4FlEJ0PK-MGM8KVWgXw" style="max-width: 100%;"/>
  </a>
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Захват трафика IMAP
  </h4>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>msf <span class="pl-k">&gt;</span> use auxiliary/server/capture/imap</pre>
 </div>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   NTLM-аутентификация — Утечка информации
  </h4>
 </div>
 <p dir="auto">
  Если сервер поддерживает NTLM-аутентификацию (Windows), можно получить чувствительную информацию,
        такую как версия ПО:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>telnet example.com 143
    <span class="pl-k">*</span> OK The Microsoft Exchange IMAP4 service is ready.
    <span class="pl-k">&gt;&gt;</span> a1 AUTHENTICATE NTLM
    +
    <span class="pl-k">&gt;&gt;</span> TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=
    +
    TlRMTVNTUAACAAAACgAKADgAAAAFgooCBqqVKFrKPCMAAAAAAAAAAEgASABCAAAABgOAJQAAAA9JAEkAUwAwADEAAgAKAEkASQBTADAAMQABAAoASQBJAFMAMAAxAAQACgBJAEkAUwAwADEAAwAKAEkASQBTADAAMQAHAAgAHwMI0VPy1QEAAAAA</pre>
 </div>
 <p dir="auto">
  Автоматизация через скрипт Nmap:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap --script=imap-ntlm-info.nse</pre>
 </div>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Брутфорс IMAP
  </h4>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>hydra -l USERNAME -P /path/to/passwords.txt -f <span class="pl-k">&lt;</span>IP<span class="pl-k">&gt;</span> imap -V
    hydra -S -v -l USERNAME -P /path/to/passwords.txt -s 993 -f 192.168.x.x imap -V</pre>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399164099-b85f0c5a-aa75-49b9-9e7e-44bb89770518.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MDk5LWI4NWYwYzVhLWFhNzUtNDliOS05ZTdlLTQ0YmI4OTc3MDUxOC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zNWEyNzc2MDJhOTE5Mjg0N2Y4OTNlZTEwNWY2MzU0ZDE1YTA2ODc2ZjAxYWNjZTYyNTA2N2NmZjAxNzc4NDYxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.gWLIQyYaRZZLdhE8HIn1Ofv3y4pdSz-nf2ajZIYNl_k" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164099-b85f0c5a-aa75-49b9-9e7e-44bb89770518.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MDk5LWI4NWYwYzVhLWFhNzUtNDliOS05ZTdlLTQ0YmI4OTc3MDUxOC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zNWEyNzc2MDJhOTE5Mjg0N2Y4OTNlZTEwNWY2MzU0ZDE1YTA2ODc2ZjAxYWNjZTYyNTA2N2NmZjAxNzc4NDYxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.gWLIQyYaRZZLdhE8HIn1Ofv3y4pdSz-nf2ajZIYNl_k" style="max-width: 100%;"/>
  </a>
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Использование CURL
  </h4>
 </div>
 <p dir="auto">
  Основные команды для работы с IMAP через CURL:
 </p>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre><span class="pl-c"><span class="pl-c">#</span> Список почтовых ящиков</span>
    curl -k <span class="pl-s"><span class="pl-pds">'</span>imaps://10.10.x.x/<span class="pl-pds">'</span></span> --user user:pass
    
    <span class="pl-c"><span class="pl-c">#</span> Список сообщений в папке (например, INBOX)</span>
    curl -k <span class="pl-s"><span class="pl-pds">'</span>imaps://10.10.x.x/INBOX?ALL<span class="pl-pds">'</span></span> --user user:pass
    
    <span class="pl-c"><span class="pl-c">#</span> Загрузка сообщения</span>
    curl -k <span class="pl-s"><span class="pl-pds">'</span>imaps://10.10.x.x/INBOX;MAILINDEX=1<span class="pl-pds">'</span></span> --user user:pass</pre>
 </div>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Уязвимости IMAP
  </h4>
 </div>
 <p dir="auto">
  Примеры:
 </p>
 <ul dir="auto">
  <li>
   <strong>
    Eudora Qualcomm WorldMail 3.0 [CVE-2005-4267]
   </strong>
   <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
    <pre>msf <span class="pl-k">&gt;</span> use exploit/windows/imap/eudora_list</pre>
   </div>
  </li>
  <li>
   <strong>
    IMAP Fuzzer
   </strong>
   <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
    <pre>msf <span class="pl-k">&gt;</span> use auxiliary/dos/windows/imap/fuzz_imap</pre>
   </div>
  </li>
 </ul>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Лучшие практики пентеста POP3
  </h3>
 </div>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   POP3
  </h4>
 </div>
 <p dir="auto">
  POP3 обычно использует порты 110 и 995.
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Что такое POP3?
  </h4>
 </div>
 <p dir="auto">
  POP3 (Post Office Protocol) позволяет скачивать письма на локальное устройство, после чего они обычно
        удаляются с почтового сервера. Это означает, что письма привязаны к конкретному устройству и недоступны для
        других клиентов после загрузки.
 </p>
 <div class="snippet-clipboard-content notranslate position-relative overflow-auto">
  <pre class="notranslate"><code>PORT     STATE SERVICE               VERSION
    110/tcp  open  pop3                  Zimbra Collabration Suite pop3d
    </code></pre>
 </div>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Пентест POP3
  </h4>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Поиск с помощью Shodan:
  </h5>
 </div>
 <div class="snippet-clipboard-content notranslate position-relative overflow-auto">
  <pre class="notranslate"><code>port:110, 995
    </code></pre>
 </div>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Захват баннеров:
  </h5>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>telnet 10.10.x.x 110
    nc -nv 10.10.x.x 110
    nmap -p110 --script=banner 10.10.x.x</pre>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399164153-4197e8cf-3a33-405a-bed5-447033451b6f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MTUzLTQxOTdlOGNmLTNhMzMtNDA1YS1iZWQ1LTQ0NzAzMzQ1MWI2Zi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1iMmZiZjljZjM5MTQyZmMyZDcxYjZhZGFiMjY3OTMyYTg1YjA1MDYwNzg0Y2ZkZTA4MDI5MWRhYjRiZDEwYTQ3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.iHF7VXEFI_I2NbeCeq8J2rlpvxZEBzOyq-qEyZQt8TY" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164153-4197e8cf-3a33-405a-bed5-447033451b6f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MTUzLTQxOTdlOGNmLTNhMzMtNDA1YS1iZWQ1LTQ0NzAzMzQ1MWI2Zi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1iMmZiZjljZjM5MTQyZmMyZDcxYjZhZGFiMjY3OTMyYTg1YjA1MDYwNzg0Y2ZkZTA4MDI5MWRhYjRiZDEwYTQ3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.iHF7VXEFI_I2NbeCeq8J2rlpvxZEBzOyq-qEyZQt8TY" style="max-width: 100%;"/>
  </a>
 </p>
 <div class="markdown-heading" dir="auto">
  <h5 class="heading-element" dir="auto" tabindex="-1">
   Определение возможностей POP3:
  </h5>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>nmap --script <span class="pl-s"><span class="pl-pds">"</span>pop3-capabilities or pop3-ntlm-info<span class="pl-pds">"</span></span> -sV -port 110 192.168.x.x</pre>
 </div>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399164165-497fa1ac-e503-4144-8be2-fe112e8e5646.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MTY1LTQ5N2ZhMWFjLWU1MDMtNDE0NC04YmUyLWZlMTEyZThlNTY0Ni5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yZjNlZDJkMDBmZDNhNGUxOGQ4ZGQyNmY4NDU4YjA3MTRjM2U2OWNkMWI4NTliYjE5YzI4MDI1MmIwZWJlOWRjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.NdogC_f6YFw1k9DRANt3qLnaQ16Z4DHXGK19qkpeMd4" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164165-497fa1ac-e503-4144-8be2-fe112e8e5646.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MTY1LTQ5N2ZhMWFjLWU1MDMtNDE0NC04YmUyLWZlMTEyZThlNTY0Ni5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yZjNlZDJkMDBmZDNhNGUxOGQ4ZGQyNmY4NDU4YjA3MTRjM2U2OWNkMWI4NTliYjE5YzI4MDI1MmIwZWJlOWRjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.NdogC_f6YFw1k9DRANt3qLnaQ16Z4DHXGK19qkpeMd4" style="max-width: 100%;"/>
  </a>
 </p>
 <p dir="auto">
  <a href="https://private-user-images.githubusercontent.com/146094679/399164171-3169c519-7ea3-4f15-a254-5f2b02c7defb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MTcxLTMxNjljNTE5LTdlYTMtNGYxNS1hMjU0LTVmMmIwMmM3ZGVmYi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05ZDhjZjliZjQ5ODI1MmI4MTVlNzUwMzA4NzM4ZmJhNWY0NDI2MmY0OTg5M2I1MzcwM2E0N2RmODc0MTU2YzFiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.AZD5nGOBDFC7bSnYpoy62RalKknok3-XMlZ3oV7XNPw" rel="noopener noreferrer" target="_blank">
   <img alt="image" src="https://private-user-images.githubusercontent.com/146094679/399164171-3169c519-7ea3-4f15-a254-5f2b02c7defb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDUxNDk4ODYsIm5iZiI6MTc0NTE0OTU4NiwicGF0aCI6Ii8xNDYwOTQ2NzkvMzk5MTY0MTcxLTMxNjljNTE5LTdlYTMtNGYxNS1hMjU0LTVmMmIwMmM3ZGVmYi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNDIwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDQyMFQxMTQ2MjZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05ZDhjZjliZjQ5ODI1MmI4MTVlNzUwMzA4NzM4ZmJhNWY0NDI2MmY0OTg5M2I1MzcwM2E0N2RmODc0MTU2YzFiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.AZD5nGOBDFC7bSnYpoy62RalKknok3-XMlZ3oV7XNPw" style="max-width: 100%;"/>
  </a>
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Перехват трафика POP3
  </h4>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>msf <span class="pl-k">&gt;</span> use auxiliary/server/capture/pop3</pre>
 </div>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Брутфорс POP3
  </h4>
 </div>
 <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
  <pre>hydra -l USERNAME -P /path/to/passwords.txt -f <span class="pl-k">&lt;</span>IP<span class="pl-k">&gt;</span> pop3 -V
    hydra -S -v -l USERNAME -P /path/to/passwords.txt -s 995 -f <span class="pl-k">&lt;</span>IP<span class="pl-k">&gt;</span> pop3 -V</pre>
 </div>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h4 class="heading-element" dir="auto" tabindex="-1">
   Уязвимости POP3
  </h4>
 </div>
 <p dir="auto">
  Примеры:
 </p>
 <ul dir="auto">
  <li>
   <strong>
    Seattle Lab Mail 5.5 [CVE-2003-0264]
   </strong>
   <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
    <pre>msf <span class="pl-k">&gt;</span> use exploit/windows/pop3/seattlelab_pass</pre>
   </div>
  </li>
  <li>
   <strong>
    Cyrus – Gentoo 2006.0 Linux 2.6 [CVE-2006-2502]
   </strong>
   <div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto">
    <pre>msf <span class="pl-k">&gt;</span> use exploit/linux/pop3/cyrus_pop3d_popsubfolders</pre>
   </div>
  </li>
 </ul>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Практика
  </h3>
 </div>
 <ol dir="auto">
  <li>
   <p dir="auto">
    <strong>
     Настройка тестового окружения:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Поднять локальный SMTP, POP3, IMAP-серверы (например, с использованием Docker).
    </li>
    <li>
     Настроить уязвимости (открытые релееры, отсутствие SSL/TLS).
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Решение задач:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Начать с анализа сетевого трафика.
    </li>
    <li>
     Понять структуру команд протоколов.
    </li>
    <li>
     Использовать команды протоколов для взаимодействия с сервером (например,
     <code>
      EXAMINE
     </code>
     и
     <code>
      FETCH
     </code>
     в IMAP).
    </li>
   </ul>
  </li>
  <li>
   <p dir="auto">
    <strong>
     Тренировка на CTF-платформах:
    </strong>
   </p>
   <ul dir="auto">
    <li>
     Попробовать задачи на HackTheBox, TryHackMe, CTFLearn, OverTheWire.
    </li>
    <li>
     Решить сценарии, связанные с почтовыми протоколами.
    </li>
   </ul>
  </li>
 </ol>
 <div class="markdown-heading" dir="auto">
  <h3 class="heading-element" dir="auto" tabindex="-1">
   Пример разбора задачи
  </h3>
 </div>
 <ol dir="auto">
  <li>
   <strong>
    Условие:
   </strong>
   Имеется дамп трафика, перехваченного с почтового сервера. Найти флаг.
  </li>
  <li>
   <strong>
    Решение:
   </strong>
   <ul dir="auto">
    <li>
     Открыть дамп в Wireshark, отфильтровать трафик по порту (25, 110, 143).
    </li>
    <li>
     Декодировать Base64 содержимое письма.
    </li>
    <li>
     Найти флаг в теле или заголовках сообщения.
    </li>
   </ul>
  </li>
 </ol>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Заключение
  </h2>
 </div>
 <p dir="auto">
  Почтовые протоколы остаются важным элементом инфраструктуры, а их уязвимости — частой целью атак.
        Знание тонкостей работы SMTP, POP3 и IMAP, а также их уязвимостей, позволяет не только улучшить безопасность
        систем, но и успешно решать задачи на CTF. Постоянная практика, анализ трафика и изучение реальных уязвимостей
        помогут углубить знания и подготовиться к соревнованиям.
 </p>
 <hr/>
 <div class="markdown-heading" dir="auto">
  <h2 class="heading-element" dir="auto" tabindex="-1">
   Список источников
  </h2>
 </div>
 <ol dir="auto">
  <li>
   RFC 5321 - Simple Mail Transfer Protocol (SMTP):
   <a href="https://datatracker.ietf.org/doc/html/rfc5321" rel="nofollow">
    https://datatracker.ietf.org/doc/html/rfc5321
   </a>
  </li>
  <li>
   RFC 1939 - Post Office Protocol - Version 3 (POP3):
   <a href="https://datatracker.ietf.org/doc/html/rfc1939" rel="nofollow">
    https://datatracker.ietf.org/doc/html/rfc1939
   </a>
  </li>
  <li>
   RFC 3501 - Internet Message Access Protocol (IMAP):
   <a href="https://datatracker.ietf.org/doc/html/rfc3501" rel="nofollow">
    https://datatracker.ietf.org/doc/html/rfc3501
   </a>
  </li>
  <li>
   Wireshark Documentation:
   <a href="https://www.wireshark.org/docs/" rel="nofollow">
    https://www.wireshark.org/docs/
   </a>
  </li>
  <li>
   HackTheBox Academy - Protocol Analysis:
   <a href="https://academy.hackthebox.com" rel="nofollow">
    https://academy.hackthebox.com
   </a>
  </li>
  <li>
   OverTheWire - Wargames:
   <a href="https://overthewire.org/wargames" rel="nofollow">
    https://overthewire.org/wargames
   </a>
  </li>
  <li>
   Practical Ethical Hacking by TCM Security:
   <a href="https://tcm-sec.com" rel="nofollow">
    https://tcm-sec.com
   </a>
  </li>
  <li>
   <a href="https://hackviser.com/tactics/pentesting/services/imap" rel="nofollow">
    https://hackviser.com/tactics/pentesting/services/imap
   </a>
  </li>
  <li>
   <a href="https://hackviser.com/tactics/pentesting/services/smtp" rel="nofollow">
    https://hackviser.com/tactics/pentesting/services/smtp
   </a>
  </li>
  <li>
   <a href="https://hackviser.com/tactics/pentesting/services/pop3" rel="nofollow">
    https://hackviser.com/tactics/pentesting/services/pop3
   </a>
  </li>
  <li>
   <a href="https://luemmelsec.github.io/Pentest-Everything-SMTP/" rel="nofollow">
    https://luemmelsec.github.io/Pentest-Everything-SMTP/
   </a>
  </li>
  <li>
   <a href="https://shahmeeramir.com/penetration-testing-an-smtp-server-cf91e4846101" rel="nofollow">
    https://shahmeeramir.com/penetration-testing-an-smtp-server-cf91e4846101
   </a>
  </li>
  <li>
   <a href="https://secybr.com/posts/imap-pentesting-best-practices/" rel="nofollow">
    https://secybr.com/posts/imap-pentesting-best-practices/
   </a>
  </li>
  <li>
   <a href="https://secybr.com/posts/pop3-pentesting-best-practices/" rel="nofollow">
    https://secybr.com/posts/pop3-pentesting-best-practices/
   </a>
  </li>
  <li>
   <a href="https://helladmin.gitbooks.io/pentesting-handbook/content/phase-2-scanning/service-enumeration/25-tcp-simple-mail-transfer-protocol-smtp.html" rel="nofollow">
    https://helladmin.gitbooks.io/pentesting-handbook/content/phase-2-scanning/service-enumeration/25-tcp-simple-mail-transfer-protocol-smtp.html
   </a>
  </li>
  <li>
   <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/10-Testing_for_IMAP_SMTP_Injection" rel="nofollow">
    https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/10-Testing_for_IMAP_SMTP_Injection
   </a>
  </li>
  <li>
   <a href="https://docs.cobalt.io/methodologies/external-network/" rel="nofollow">
    https://docs.cobalt.io/methodologies/external-network/
   </a>
  </li>
  <li>
   <a href="https://csbygb.gitbook.io/pentips/networking-protocols-and-network-pentest/imap" rel="nofollow">
    https://csbygb.gitbook.io/pentips/networking-protocols-and-network-pentest/imap
   </a>
  </li>
  <li>
   <a href="https://csbygb.gitbook.io/pentips/networking-protocols-and-network-pentest/pop3" rel="nofollow">
    https://csbygb.gitbook.io/pentips/networking-protocols-and-network-pentest/pop3
   </a>
  </li>
  <li>
   <a href="https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/" rel="nofollow">
    https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/
   </a>
  </li>
  <li>
   <a href="https://beaglesecurity.com/blog/vulnerability/imap-smtp-injection.html" rel="nofollow">
    https://beaglesecurity.com/blog/vulnerability/imap-smtp-injection.html
   </a>
  </li>
 </ol>
</article>
